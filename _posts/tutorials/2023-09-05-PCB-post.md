---
layout: post
title: 15. PCB Thermal Simulation
category: tutorials
---

# PCB Thermal Simulation

## * [격자 파일 다운로드](https://drive.google.com/file/d/1mHUdIGJCk5jwTuIWd8pMqmDvD0OL9dnE/view?usp=sharing)

## 1) 개요 
* 본 예제는 PCB 기판의 소자들에 전력을 인가할 시, 발생하는 발열을 예측하는 해석이다.<br>

* 소자들에서 발생하는 열은 전도 및 대류 현상으로 PCB 기판 및 주변 공기에 전달된다.<br>

* 소자 및 PCB는 고체 영역, 주변 공기는 유체 영역으로 나누어 multi-region 방식으로 계산된다.<br>

* 솔버는 넥스트폼에서 개발한 chtMultiRegionSimpleNFoam으로 계산한다.<br>

* 격자는 아래 그림에 나타내었다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/1.png"><br>
</p>

계산 조건은 다음과 같다. <br>

●  solver : chtMultiRegionSimpleNFoam<br>

●  난류 모델 : Laminar <br>

●  공기의 물성치<br>
   ```밀도 : Perfect Gas```<br>
   ```점성 계수 : 1.79e-5𝑘𝑔/𝑚s```<br>
   ```열전도도 : 0.0245W/mK```<br>
   ```비열 : 1,006J/kg```<br>

●  Silicon의 물성치<br>
   ```밀도 : 2329kg/m<sup>3</sup>```<br>
   ```열전도도 : 130W/mK```<br>
   ```비열 : 700J/kg```<br>

●  Aluminum의 물성치<br>
   ```밀도 : 2700kg/m<sup>3</sup>```<br>
   ```열전도도 : 238W/mK```<br>
   ```비열 : 900J/kg```<br>

●  Glass의 물성치<br>
   ```밀도 : 2210kg/m<sup>3</sup>```<br>
   ```열전도도 : 1.4W/mK```<br>
   ```비열 : 730J/kg```<br>

●  Thermal-Grease의 물성치<br>
   ```밀도 : 2600kg/m<sup>3</sup>```<br>
   ```열전도도 : 3W/mK```<br>
   ```비열 : 1200J/kg```<br>

BARAM을 실행하면 아래 과정을 따라서 case 파일을 만든다.<br>

●  New Case버튼 클릭<br>

●  Project Name : PCB<br>

●  Flow Type : incompressible<br>

●  Multiphase Model : Off<br>

● Species Model : Not Include<br>

## 2) 격자
격자는 주어진 OpenFOAM의 polyMesh 폴더를 활용한다. <br>
상단 탭에서 File - Load Mesh - OpenFOAM 순서대로 클릭하고 polyMesh 폴더를 선택한다. <br>

## 3) 계산 조건
### (1) General
본 예제에서는 중력을 -z 방향으로 설정한다.<br>
Gravity는 Z축에 -9.81을 입력한다.<br>

### (2) Models
난류 모델은 Laminar 모델을 사용하고 Energy는 include로 설정한다. <br>

### (3) Materials
본 예제에서는 공기와 Silicon, Aluminum, Glass, Thermal-Grease같은 다양한 고체를 사용한다.<br>
물성치는 아래와 같이 설정한다.<br>
Materials의 +버튼을 클릭하여 고체 하나를 생성한 후, 다음과 같이 물성치를 변경한다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/2.png"><br>
</p>

***●  Air***<br>
```Density : Perfect Gas```<br>
```Specific Heat (C<sub>p</sub>) : 1,006```<br>
```Viscosity : 1.79e-05```<br>
```Thermal Conductivity : 0.0245```<br>
```Molecular Weight : 28.966```<br>
```Absorption Coefficient : 0.0```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/3.png"><br>
</p>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/4.png"><br>
</p>

***●  Silicon***<br>
```Density : 2329```<br>
```Specific Heat (C<sub>p</sub>) : 700```<br>
```Thermal Conductivity : 130```<br>
```Emissivity : 0.023```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/5.png"><br>
</p>

***●  Aluminum***<br>
```Density : 2700```<br>
```Specific Heat (C<sub>p</sub>) : 900```<br>
```Thermal Conductivity : 238```<br>
```Emissivity : 0.039```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/6.png"><br>
</p>

***●  glass***<br>
```Density : 2210```<br>
```Specific Heat (C<sub>p</sub>) : 730```<br>
```Thermal Conductivity : 1.4```<br>
```Emissivity : 0.0```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/7.png"><br>
</p>

***●  Thermal-Grease***<br>
```Density : 2600```<br>
```Specific Heat (C<sub>p</sub>) : 1200```<br>
```Thermal Conductivity : 3```<br>
```Emissivity : 0.066```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/8.png"><br>
</p>

물성치에서는 Emissivity를 설정한다.<br>
하지만 실제 해석은 복사 모델없이 진행되므로 고려되지 않는다.<br>

### (4) Cell Zone Conditions
각 Cell Zone 영역에 맞는 Materials을 설정해야한다.<br>
Cell Zone 및 Region의 Material은 아래와 같다.

|Cell Zone|Material|
|---|---|
|Fluid|air|
|chip, part11~14|silicon|
|heatsink|aluminum|
|pcb|glass|
|tim|Thermal-Grease|

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/9.png"><br>
</p>

각 Cell Zone에 Materials을 정의하는 방법은 아래와 같다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/10.png"><br>
</p>

위 사진처럼 Fluid, chip, heatsink등의 Cell Zone을 더블 클릭한다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/11.png"><br>
</p>

Materials에서 Cell Zone에 맞는 Material을 설정한다.<br>
이후, Cell Zone에 발열량 조건을 입력한다.<br>

***●  chip***<br>
```Material : silicon```<br>
```Source Terms : Energy```<br>
```Specification Method : Value per Unit Volume```<br>
```Value : 3.36e+05```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/12.png"><br>
</p>

***●  heatsink***<br>
```Material : aluminum```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/13.png"><br>
</p>

***●  part11***<br>
```Material : silicon```<br>
```Source Terms : Energy```<br>
```Specification Method : Value per Unit Volume```<br>
```Value : 2.09e+04```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/14.png"><br>
</p>

***●  part12***<br>
```Material : silicon```<br>
```Source Terms : Energy```<br>
```Specification Method : Value per Unit Volume```<br>
```Value : 3.25e+04```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/15.png"><br>
</p>

***●  part13***<br>
```Material : silicon```<br>
```Source Terms : Energy```<br>
```Specification Method : Value per Unit Volume```<br>
```Value : 9.52e+03```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/16.png"><br>
</p>

***●  part14***<br>
```Material : silicon```<br>
```Source Terms : Energy```<br>
```Specification Method : Value per Unit Volume```<br>
```Value : 2.61+03```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/17.png"><br>
</p>

***●  pcb***<br>
```Material : glass```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/18.png"><br>
</p>

***●  tim***<br>
```Material : Thermal-Grease```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/19.png"><br>
</p>

### (5) Boundary Conditions
아래와 같이 경계면 타입과 경계값을 설정한다.<br>

**※XXX_surface와 XXX_surface_slave는 같은 면을 지칭한다. 이에 경계조건은 Thermo-Coulped Wall로 설정하여 두 면을 묶어줘야한다.<br>**

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/20.png"><br>
</p>

Fluid 영역의 Fluid_OOOO 경계면은 모두 Pressure Outlet으로 설정한다.<br>

***●  Fluid_OOOO : Pressure Outlet***<br>
```Total Pressure (Pa) : 0```<br>
```Calculate Backflow```
```Temperature : 293 (K)```<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/21.png"><br>
</p>

### (6) Numerical Conditions
Numerical Conditions은 다음과 같이 설정한다.<br>

●  Pressure-Velocity Coupling Scheme : SIMPLE<br>

●  Discretization Schemes<br>
```Momentum : First Order Upwind```<br>
```Energy : First Order Upwind```<br>

●  Under-Relaxation Factors & Convergence Criteria<br>
모두 Default 값을 사용한다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/22.png"><br>
</p>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/23.png"><br>
</p>

### (7) Monitoring
본 예제에서는 소자 및 PCB 기판의 최대 온도를 모니터링한다.<br>
Monitoring tab에서 Add - Volumes를 클릭 후, 다음과 같이 설정한다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/24.png"><br>
</p>

위 그림과 같이 모든 소자들에 대해 Volume의 Maximum Temperature Monitoring 설정을 진행한다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/25.png"><br>
</p>

### (8) Initialization
초기화는 각 Cell Zone 별로 초기화를 진행할 수 있다.<br>
하단 탭에서 각 Cell Zone을 선택할 수 있다.<br>
본 예제에서는 모든 Cell Zone에 같은 값을 입력한다.

●  Velocity : 0 (m/s)<br>

●  Pressure : 0 (Pa)<br>

●  Temperature : 330 (K)<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/26.png"><br>
</p>

설정 완료 후, Initialize 버튼을 누르면 된다.<br>

### (9) Run
Run Conditions에서 다음과 같이 설정 후 계산을 진행한다.<br>

●  Number of Iterations : 20000  <br>

●  Save Interval : 2000  <br>

●  Data Write Format : Binary  <br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/27.png"><br>
</p>

Parallel에서 Number of Cores는 8로 설정한다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/28.png"><br>
</p>

이후 계산을 진행한다.

## 4) 후처리
계산이 완료된 시점에서 Residuals과 Monitoring은 아래와 같다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/29.png"><br>
</p>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/30.png"><br>
</p>

각 소자 및 PCB의 최대 온도는 아래와 같다.<br>

|Part Name|Maximum Temperature (K)|
|---|---|
|chip|347.5|
|part11|301|
|part12|302|
|part13|302|
|part14|296|
|pcb|347.5|

이후, External Tools - Paraview를 실행하여 정성적인 결과를 확인한다.<br>
Slice 기능을 활용하여 단면을 자르고 단면에서 온도 분포를 확인한다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/31.png"><br>
</p>

아래 그림과 같이 chip 주변에서 온도 분포를 확인할 수 있다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/32.png"><br>
</p>

Glyph 기능을 활용하면 아래 그림과 같이 pcb 주변의 유동 분포를 확인할 수 있다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/33.png"><br>
</p>

Glyph 기능을 추가하고 MultiBlock Inspector 탭에서 Fluid만 활성화한다.

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/34.png"><br>
</p>

Properties 탭에서 Orientation Array와 Scale Array를 U (Partial)로 변경한다.<br>

<p align='center'>
    <img src="https://github.com/nextfoam/baram-pages/raw/main/screenshots/pcb/35.png"><br>
</p>